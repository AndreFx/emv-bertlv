package io.github.binaryfoo.decoders;

import static io.github.binaryfoo.DecodedAsStringMatcher.decodedAsString;
import static org.hamcrest.core.Is.is;
import static org.junit.Assert.*;

import java.util.List;

import io.github.binaryfoo.DecodedAsStringMatcher;
import io.github.binaryfoo.EmvTags;
import io.github.binaryfoo.tlv.CompliantTagMode;
import io.github.binaryfoo.tlv.Tag;
import org.junit.Test;

import io.github.binaryfoo.DecodedData;


public class TLVDecoderTest {

	TLVDecoder decoder = new TLVDecoder();
	DecodeSession session = new DecodeSession();

	@Test
	public void testDecode() {
        String input = "E05A9F020600000000500082025C009F360200019F260886087FD3A9FE6FB49F100706010A03A010009F3303E0F0C09F1A0200365F2A0200369F1E08424B00081905CB9F950500000080009A030809229C01009F37041035EA1F8A00";
        session.setTagMetaData(EmvTags.METADATA);
        List<DecodedData> actual = decoder.decode(input, 0, session);
		assertThat(actual.get(0).getTag(), is(Tag.fromHex("E0")));
	}

	@Test
	public void tryASecondTimeIfCommonErrorVendorTagsExist() throws Exception {
		String input = "5F2002202F5F24031508315F2D047275656E5F280206438F01059F3201034F07A0000000041010500A4D415354455243415244870101820200809F080200025F300202215F25031411015A0854204855377881545F34010157135420485537788154D15082211839409890000F9F1F183138333934303030303030303030303938393030303030309F4A01828C249F02069F03069F1A0295055F2A029A039C019F37049F35019F45029F4C089F34039F15028D0C910A8A0295059F37049F4C089081B083E28958C1C1A1AA31DD4611C3B3B1FCBEE937B92A7ED93AE49D9510028907C4F5A685AF2A100FA347282F1BB3ADF26E2CB495080B20AE4A5614A9DF6602764177FBEE38624489AC6C4C054EAFC305D895A76885CE53A1BFDF5CB6CCE42E8E0E12382DB606490EE8075BC69D90205614B27745F7D883DB449758C340888B47B947945F062348A4DD4636D75A5D421638B6CA86B0618005C9F8F5D59DED345130123F0BD8C1EF7EC6F32A38BD0421FC39922424A72C60B6F51D90F08F422DBA97429B21017F8080A05933C0A4D70728BD68E665CD19E19F84100C9291EA7DB1EA276A8C96999DF512A69F86109C7C13CB1EBCD8C38818CB4EE91DA1589F8810FC28203B337296C500C3A272DA4767569F8A10253BC17EE2DE49451157405E9EA8C78D9F8503D119AC9F8703E6DF7C9F8903E08A739F8B0345C962DF2008ABE7D77B1E6970CB9F1101019F120A4D4153544552434152449F38039F1A029F49039F37049F4401028407A0000000041010BF0C059F4D020B0A9F2301009F1401009F42020643C303000000C403195000C50319FB00C7012DC8020643C9020643CA06000000000000CB06000000000000D11906430000000643000000064300000006430000000643000000D312000000000000000000000000000000000000D50404180200D60200109F7E30031021120002000000000000000000000000000000000000000000000000000000000000000000000000000000000000563442353432303438353533373738383135345E202F5E313530383232313031303030303030303030303030303030303030303030309F620600000000000E9F630600000000FE009F6401059F6502000E9F660207F09F6701059F6B135420485537788154D15082210100000000000FD704000024E0D8021980D9080801010010010301DA020000DB020000DC021E82DD02EA129F8C81B0A817FE4C94B779BC045870E11E1B233F5B2A119FBE8DB13D4A16DD70633AC2DA375536107D3DE7264ABBAA6AA5B25C221C9F6E3FEE038287492820434F40A70B9D99F0CEF237714FC85650A0352CF9CA4A31B7D9FC1703AAF4B00619E603A69D0A99B8AB2A59E8348F2057E434BD6A51AA087DBDDE7E61FC67D74D90F9E3D9A795889C05A84B60E531A1144001DA7B958EC8631BC3E358DA2352E094A5F835D63B9184D8D7EA807C4EFB55E233FD07A79F4701039F48009F6C0200019F83820118ACFB1B0537769E3B87AED410119795D14438EE3163B148827AFC63A669E6AE29DAF65E8A4915600817E3FFD31471A08C8C7C7E23A938E9714EA058257F5738E48408DC46ACEA06C71E83537F65C53C1C5BA6A57ACD6CB20E9B510D8AF7F002F2D3F62B2B14B980709845BAC035B74142E32C571DACF8F1482A93132F6C401E3071A56864FF2BC1F94F4B0008EF373FE556647BDF6CD6A8897B82C22AA9E4F37F1E590B981C50F7B12762E8B16DB336D8F338582E32EF720C3186CA6EE2B306E4E81CF6565A0F498B6E7AB6A90BCE02881692063F1E5B7E7BACECA95D83C065DBC0E96881584F60014FBEE12CA7ECE65D4CFA07D9D0BCF721FC308CB0CBB900D743F7EAA99B0723E8FA5F9F18B565C83948CEC67B685F6FE88E0E000000000000000042031E031F039F0702FF009F0D05B4508400009F0E0500000000009F0F05B4708480009F1701039F690F9F6A049F7E019F02065F2A029F1A029F4D020B0A9F8D024E20DF11020100DF1202C129DF14020000DF15020000DF16020643DF171906430000000643000000064300000006430000000643000000DF1806000000000000DF1906000000000000DF5502001E9404200101009F8E024E20DF4F020000DF5A03000000DF5B03000000DF5903000000DF5C03060000DF5E03005000DF4503000000DF5D03000000DF460300A000DF1A020100DF1B02E129DF1D020000DF1E020000DF1F0100DF210100DF4D02001EDF490100DF4A02001E9F6E07064300003039009F5D03000400DF600100DF610100DF480100DF560100DF5F0100DF4C1000112233445566778899AABBCCDDEEFFDF501000000000000000000000000000000000DF53140000000000000000000000000000000000000000DF5706000000000000DF5801009F2A0102DF43020000DF440200009F51039F3704";
		session.setTagMetaData(EmvTags.METADATA);
		List<DecodedData> actual = decoder.decode(input, 0, session);
		assertThat(actual, decodedAsString("5F20 (card holder name):  /\n" +
				"5F24 (card expiry): 150831\n" +
				"5F2D (language preference): ruen\n" +
				"5F28 (issuer country code): RUS (Russian Federation)\n" +
				"8F (ca public key index): 05\n" +
				"9F32 (issuer public key exponent): 03\n" +
				"4F (ADF - Application dedicated file name): A0000000041010\n" +
				"50 (application label): MASTERCARD\n" +
				"87 (application priority indicator): 01\n" +
				"82 (AIP - Application Interchange Profile): 0080\n" +
				"  0080 (Byte 2 Bit 8): EMV and Magstripe Modes Supported\n" +
				"9F08 (card application version number): 0002\n" +
				"5F30 (service code): 0221\n" +
				"5F25 (application effective date): 141101\n" +
				"5A (PAN): 5420485537788154\n" +
				"5F34 (PAN sequence number): 01\n" +
				"57 (track 2 equivalent data): 5420485537788154D15082211839409890000F\n" +
				"9F1F (track 1 discretionary data): 183940000000000989000000\n" +
				"9F4A (SDA tag list): 82\n" +
				"8C (CDOL 1 - Card risk management data object list 1): 9F02069F03069F1A0295055F2A029A039C019F37049F35019F45029F...1502\n" +
				"  9F02 (amount authorized) 6 bytes\n" +
				"  9F03 (amount other) 6 bytes\n" +
				"  9F1A (terminal country code) 2 bytes\n" +
				"  95 (TVR - Terminal Verification Results) 5 bytes\n" +
				"  5F2A (terminal currency code) 2 bytes\n" +
				"  9A (transaction date) 3 bytes\n" +
				"  9C (transaction type) 1 bytes\n" +
				"  9F37 (unpredictable number) 4 bytes\n" +
				"  9F35 (terminal type) 1 bytes\n" +
				"  9F45 (data authentication code) 2 bytes\n" +
				"  9F4C (ICC dynamic number) 8 bytes\n" +
				"  9F34 (CVM Results - Cardholder Verification Results) 3 bytes\n" +
				"  9F15 (merchant category code) 2 bytes\n" +
				"8D (CDOL 2 - Card risk management data object list 2): 910A8A0295059F37049F4C08\n" +
				"  91 (issuer authentication data) 10 bytes\n" +
				"  8A (authorisation response code) 2 bytes\n" +
				"  95 (TVR - Terminal Verification Results) 5 bytes\n" +
				"  9F37 (unpredictable number) 4 bytes\n" +
				"  9F4C (ICC dynamic number) 8 bytes\n" +
				"90 (issuer public key certificate): 83E28958C1C1A1AA31DD4611C3B3B1FCBEE937B92A7ED93AE49D9510028907C4F5A685AF2A100FA347282F1BB3ADF26E2CB495080B20AE4A5614A9DF6602764177FBEE38624489AC6C4C054EAFC305D895A76885CE53A1BFDF5CB6CCE42E8E0E12382DB606490EE8075BC69D90205614B27745F7D883DB449758C340888B47B947945F062348A4DD4636D75A5D421638B6CA86B0618005C9F8F5D59DED345130123F0BD8C1EF7EC6F32A38BD0421FC39\n" +
				"92 (issuer public key remainder): 24A72C60B6F51D90F08F422DBA97429B21017F8080A05933C0A4D70728BD68E665CD19E1\n" +
				"9F84 (?): 0C9291EA7DB1EA276A8C96999DF512A6\n" +
				"9F86 (?): 9C7C13CB1EBCD8C38818CB4EE91DA158\n" +
				"9F88 (?): FC28203B337296C500C3A272DA476756\n" +
				"9F8A (?): 253BC17EE2DE49451157405E9EA8C78D\n" +
				"9F85 (?): D119AC\n" +
				"9F87 (?): E6DF7C\n" +
				"9F89 (?): E08A73\n" +
				"9F8B (?): 45C962\n" +
				"DF20 (?): ABE7D77B1E6970CB\n" +
				"9F11 (issuer code table index): 01\n" +
				"9F12 (application preferred name): MASTERCARD\n" +
				"9F38 (PDOL - Processing data object list): 9F1A02\n" +
				"  9F1A (terminal country code) 2 bytes\n" +
				"9F49 (DDOL - dynamic data authentication data object list): 9F3704\n" +
				"  9F37 (unpredictable number) 4 bytes\n" +
				"9F44 (application currency exponent): 02\n" +
				"84 (dedicated file name): A0000000041010\n" +
				"BF0C (FCI discretionary data): 9F4D020B0A\n" +
				"  9F4D (?): 0B0A\n" +
				"9F23 (Upper consecutive floor limit): 0\n" +
				"9F14 (Lower consecutive floor limit): 0\n" +
				"9F42 (application currency code): RUB (Russian Ruble)\n" +
				"C3 (?): 000000\n" +
				"C4 (?): 195000\n" +
				"C5 (?): 19FB00\n" +
				"C7 (?): 2D\n" +
				"C8 (?): 0643\n" +
				"C9 (?): 0643\n" +
				"CA (?): 000000000000\n" +
				"CB (?): 000000000000\n" +
				"D1 (?): 06430000000643000000064300000006430000000643000000\n" +
				"D3 (?): 000000000000000000000000000000000000\n" +
				"D5 (?): 04180200\n" +
				"D6 (?): 0010\n" +
				"9F7E (?): 031021120002000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n" +
				"56 (track 1 equivalent data): B5420485537788154^ /^1508221010000000000000000000000\n" +
				"9F62 (?): 00000000000E\n" +
				"9F63 (?): 00000000FE00\n" +
				"9F64 (?): 05\n" +
				"9F65 (?): 000E\n" +
				"9F66 (?): 07F0\n" +
				"9F67 (?): 05\n" +
				"9F6B (?): 5420485537788154D15082210100000000000F\n" +
				"D7 (?): 000024E0\n" +
				"D8 (?): 1980\n" +
				"D9 (?): 0801010010010301\n" +
				"DA (?): 0000\n" +
				"DB (?): 0000\n" +
				"DC (?): 1E82\n" +
				"DD (?): EA12\n" +
				"9F8C (?): A817FE4C94B779BC045870E11E1B233F5B2A119FBE8DB13D4A16DD70633AC2DA375536107D3DE7264ABBAA6AA5B25C221C9F6E3FEE038287492820434F40A70B9D99F0CEF237714FC85650A0352CF9CA4A31B7D9FC1703AAF4B00619E603A69D0A99B8AB2A59E8348F2057E434BD6A51AA087DBDDE7E61FC67D74D90F9E3D9A795889C05A84B60E531A1144001DA7B958EC8631BC3E358DA2352E094A5F835D63B9184D8D7EA807C4EFB55E233FD07A7\n" +
				"9F47 (ICC public key exponent): 03\n" +
				"9F48 (ICC public key remainder):\n" +
				"9F6C (?): 0001\n" +
				"9F83 (?): ACFB1B0537769E3B87AED410119795D14438EE3163B148827AFC63A669E6AE29DAF65E8A4915600817E3FFD31471A08C8C7C7E23A938E9714EA058257F5738E48408DC46ACEA06C71E83537F65C53C1C5BA6A57ACD6CB20E9B510D8AF7F002F2D3F62B2B14B980709845BAC035B74142E32C571DACF8F1482A93132F6C401E3071A56864FF2BC1F94F4B0008EF373FE556647BDF6CD6A8897B82C22AA9E4F37F1E590B981C50F7B12762E8B16DB336D8F338582E32EF720C3186CA6EE2B306E4E81CF6565A0F498B6E7AB6A90BCE02881692063F1E5B7E7BACECA95D83C065DBC0E96881584F60014FBEE12CA7ECE65D4CFA07D9D0BCF721FC308CB0CBB900D743F7EAA99B0723E8FA5F9F18B565C83948CEC67B685F6FE8\n" +
				"8E (CVM List - Cardholder Verification Method List): 000000000000000042031E031F03\n" +
				"  4203: Encrypted PIN online, If terminal supports CVM, next\n" +
				"  1E03: Signature, If terminal supports CVM, FAIL\n" +
				"  1F03: No CVM required, If terminal supports CVM, FAIL\n" +
				"9F07 (application usage control): FF00\n" +
				"  8000 (Byte 1 Bit 8): Valid for domestic cash transactions\n" +
				"  4000 (Byte 1 Bit 7): Valid for international cash transactions\n" +
				"  2000 (Byte 1 Bit 6): Valid for domestic goods\n" +
				"  1000 (Byte 1 Bit 5): Valid for international goods\n" +
				"  0800 (Byte 1 Bit 4): Valid for domestic services\n" +
				"  0400 (Byte 1 Bit 3): Valid for international services\n" +
				"  0200 (Byte 1 Bit 2): Valid at ATMs\n" +
				"  0100 (Byte 1 Bit 1): Valid at terminals other than ATMs\n" +
				"9F0D (IAC default): B450840000\n" +
				"  8000000000 (Byte 1 Bit 8): Offline data authentication was not performed\n" +
				"  2000000000 (Byte 1 Bit 6): ICC data missing\n" +
				"  1000000000 (Byte 1 Bit 5): Card appears on terminal exception file\n" +
				"  0400000000 (Byte 1 Bit 3): CDA failed\n" +
				"  0040000000 (Byte 2 Bit 7): Expired application\n" +
				"  0010000000 (Byte 2 Bit 5): Requested service not allowed for card product\n" +
				"  0000800000 (Byte 3 Bit 8): Cardholder verification was not successful\n" +
				"  0000040000 (Byte 3 Bit 3): Online PIN entered\n" +
				"9F0E (IAC denial): 0000000000\n" +
				"9F0F (IAC online): B470848000\n" +
				"  8000000000 (Byte 1 Bit 8): Offline data authentication was not performed\n" +
				"  2000000000 (Byte 1 Bit 6): ICC data missing\n" +
				"  1000000000 (Byte 1 Bit 5): Card appears on terminal exception file\n" +
				"  0400000000 (Byte 1 Bit 3): CDA failed\n" +
				"  0040000000 (Byte 2 Bit 7): Expired application\n" +
				"  0020000000 (Byte 2 Bit 6): Application not yet effective\n" +
				"  0010000000 (Byte 2 Bit 5): Requested service not allowed for card product\n" +
				"  0000800000 (Byte 3 Bit 8): Cardholder verification was not successful\n" +
				"  0000040000 (Byte 3 Bit 3): Online PIN entered\n" +
				"  0000008000 (Byte 4 Bit 8): Transaction exceeds floor limit\n" +
				"9F17 (pin try counter): 03\n" +
				"9F69 (?): 9F6A049F7E019F02065F2A029F1A02\n" +
				"9F4D (?): 0B0A\n" +
				"9F8D (?): 4E20\n" +
				"DF11 (?): 0100\n" +
				"DF12 (?): C129\n" +
				"DF14 (?): 0000\n" +
				"DF15 (?): 0000\n" +
				"DF16 (?): 0643\n" +
				"DF17 (?): 06430000000643000000064300000006430000000643000000\n" +
				"DF18 (?): 000000000000\n" +
				"DF19 (?): 000000000000\n" +
				"DF55 (?): 001E\n" +
				"94 (AFL - Application File Locator): 20010100\n" +
				"  SFI 4 record 1\n" +
				"9F8E (?): 4E20\n" +
				"DF4F (JIS 2 Equivalent Data): 0000\n" +
				"DF5A (target percentage): 000000\n" +
				"DF5B (max target percentage): 000000\n" +
				"DF59 (?): 000000\n" +
				"DF5C (threshold value): 060000\n" +
				"DF5E (?): 005000\n" +
				"DF45 (?): 000000\n" +
				"DF5D (Default DDOL - Default dynamic data auth object list): 000000\n" +
				"  Error: Failed parsing 000000: BufferUnderflowException\n" +
				"DF46 (?): 00A000\n" +
				"DF1A (?): 0100\n" +
				"DF1B (?): E129\n" +
				"DF1D (?): 0000\n" +
				"DF1E (?): 0000\n" +
				"DF1F (?): 00\n" +
				"DF21 (?): 00\n" +
				"DF4D (?): 001E\n" +
				"DF49 (?): 00\n" +
				"DF4A (?): 001E\n" +
				"9F6E (?): 06430000303900\n" +
				"9F5D (?): 000400\n" +
				"DF60 (?): 00\n" +
				"DF61 (?): 00\n" +
				"DF48 (?): 00\n" +
				"DF56 (TAC default): 00\n" +
				"DF5F (BRAND_ID): 00\n" +
				"DF4C (?): 00112233445566778899AABBCCDDEEFF\n" +
				"DF50 (transaction amount): 00000000000000000000000000000000\n" +
				"DF53 (CA public key modulus): 0000000000000000000000000000000000000000\n" +
				"DF57 (TAC denial): 000000000000\n" +
				"DF58 (TAC online): 00\n" +
				"9F2A (?): 02\n" +
				"DF43 (?): 0000\n" +
				"DF44 (?): 0000\n" +
				"9F51 (?): 9F3704\n" +
				"Warning: This result is a second attempt ignoring the spec for these (often abused) tags: [9F8B, 9F8A, 9F8D, 9F8C, 9F8E, 9F87, 9F88, 9F89, 9F83, 9F84, 9F85, 9F86]. The first attempt (following the the spec) produced an error: Failed parsing TLV with tag 9F8C81B0A817: Bad length: -1799915264 < 0. Read 4 of 126 (0xFE) bytes used to encode length of TLV.\n"));
	}

	@Test
	public void giveUpOnFirstTryInCompliantMode() throws Exception {
		String input = "5F2002202F5F24031508315F2D047275656E5F280206438F01059F3201034F07A0000000041010500A4D415354455243415244870101820200809F080200025F300202215F25031411015A0854204855377881545F34010157135420485537788154D15082211839409890000F9F1F183138333934303030303030303030303938393030303030309F4A01828C249F02069F03069F1A0295055F2A029A039C019F37049F35019F45029F4C089F34039F15028D0C910A8A0295059F37049F4C089081B083E28958C1C1A1AA31DD4611C3B3B1FCBEE937B92A7ED93AE49D9510028907C4F5A685AF2A100FA347282F1BB3ADF26E2CB495080B20AE4A5614A9DF6602764177FBEE38624489AC6C4C054EAFC305D895A76885CE53A1BFDF5CB6CCE42E8E0E12382DB606490EE8075BC69D90205614B27745F7D883DB449758C340888B47B947945F062348A4DD4636D75A5D421638B6CA86B0618005C9F8F5D59DED345130123F0BD8C1EF7EC6F32A38BD0421FC39922424A72C60B6F51D90F08F422DBA97429B21017F8080A05933C0A4D70728BD68E665CD19E19F84100C9291EA7DB1EA276A8C96999DF512A69F86109C7C13CB1EBCD8C38818CB4EE91DA1589F8810FC28203B337296C500C3A272DA4767569F8A10253BC17EE2DE49451157405E9EA8C78D9F8503D119AC9F8703E6DF7C9F8903E08A739F8B0345C962DF2008ABE7D77B1E6970CB9F1101019F120A4D4153544552434152449F38039F1A029F49039F37049F4401028407A0000000041010BF0C059F4D020B0A9F2301009F1401009F42020643C303000000C403195000C50319FB00C7012DC8020643C9020643CA06000000000000CB06000000000000D11906430000000643000000064300000006430000000643000000D312000000000000000000000000000000000000D50404180200D60200109F7E30031021120002000000000000000000000000000000000000000000000000000000000000000000000000000000000000563442353432303438353533373738383135345E202F5E313530383232313031303030303030303030303030303030303030303030309F620600000000000E9F630600000000FE009F6401059F6502000E9F660207F09F6701059F6B135420485537788154D15082210100000000000FD704000024E0D8021980D9080801010010010301DA020000DB020000DC021E82DD02EA129F8C81B0A817FE4C94B779BC045870E11E1B233F5B2A119FBE8DB13D4A16DD70633AC2DA375536107D3DE7264ABBAA6AA5B25C221C9F6E3FEE038287492820434F40A70B9D99F0CEF237714FC85650A0352CF9CA4A31B7D9FC1703AAF4B00619E603A69D0A99B8AB2A59E8348F2057E434BD6A51AA087DBDDE7E61FC67D74D90F9E3D9A795889C05A84B60E531A1144001DA7B958EC8631BC3E358DA2352E094A5F835D63B9184D8D7EA807C4EFB55E233FD07A79F4701039F48009F6C0200019F83820118ACFB1B0537769E3B87AED410119795D14438EE3163B148827AFC63A669E6AE29DAF65E8A4915600817E3FFD31471A08C8C7C7E23A938E9714EA058257F5738E48408DC46ACEA06C71E83537F65C53C1C5BA6A57ACD6CB20E9B510D8AF7F002F2D3F62B2B14B980709845BAC035B74142E32C571DACF8F1482A93132F6C401E3071A56864FF2BC1F94F4B0008EF373FE556647BDF6CD6A8897B82C22AA9E4F37F1E590B981C50F7B12762E8B16DB336D8F338582E32EF720C3186CA6EE2B306E4E81CF6565A0F498B6E7AB6A90BCE02881692063F1E5B7E7BACECA95D83C065DBC0E96881584F60014FBEE12CA7ECE65D4CFA07D9D0BCF721FC308CB0CBB900D743F7EAA99B0723E8FA5F9F18B565C83948CEC67B685F6FE88E0E000000000000000042031E031F039F0702FF009F0D05B4508400009F0E0500000000009F0F05B4708480009F1701039F690F9F6A049F7E019F02065F2A029F1A029F4D020B0A9F8D024E20DF11020100DF1202C129DF14020000DF15020000DF16020643DF171906430000000643000000064300000006430000000643000000DF1806000000000000DF1906000000000000DF5502001E9404200101009F8E024E20DF4F020000DF5A03000000DF5B03000000DF5903000000DF5C03060000DF5E03005000DF4503000000DF5D03000000DF460300A000DF1A020100DF1B02E129DF1D020000DF1E020000DF1F0100DF210100DF4D02001EDF490100DF4A02001E9F6E07064300003039009F5D03000400DF600100DF610100DF480100DF560100DF5F0100DF4C1000112233445566778899AABBCCDDEEFFDF501000000000000000000000000000000000DF53140000000000000000000000000000000000000000DF5706000000000000DF5801009F2A0102DF43020000DF440200009F51039F3704";
		session.setTagMetaData(EmvTags.METADATA);
		session.setTagRecognitionMode(CompliantTagMode.INSTANCE$);
		List<DecodedData> actual = decoder.decode(input, 0, session);
		assertThat(actual, decodedAsString("5F20 (card holder name):  /\n" +
				"5F24 (card expiry): 150831\n" +
				"5F2D (language preference): ruen\n" +
				"5F28 (issuer country code): RUS (Russian Federation)\n" +
				"8F (ca public key index): 05\n" +
				"9F32 (issuer public key exponent): 03\n" +
				"4F (ADF - Application dedicated file name): A0000000041010\n" +
				"50 (application label): MASTERCARD\n" +
				"87 (application priority indicator): 01\n" +
				"82 (AIP - Application Interchange Profile): 0080\n" +
				"  0080 (Byte 2 Bit 8): EMV and Magstripe Modes Supported\n" +
				"9F08 (card application version number): 0002\n" +
				"5F30 (service code): 0221\n" +
				"5F25 (application effective date): 141101\n" +
				"5A (PAN): 5420485537788154\n" +
				"5F34 (PAN sequence number): 01\n" +
				"57 (track 2 equivalent data): 5420485537788154D15082211839409890000F\n" +
				"9F1F (track 1 discretionary data): 183940000000000989000000\n" +
				"9F4A (SDA tag list): 82\n" +
				"8C (CDOL 1 - Card risk management data object list 1): 9F02069F03069F1A0295055F2A029A039C019F37049F35019F45029F...1502\n" +
				"  9F02 (amount authorized) 6 bytes\n" +
				"  9F03 (amount other) 6 bytes\n" +
				"  9F1A (terminal country code) 2 bytes\n" +
				"  95 (TVR - Terminal Verification Results) 5 bytes\n" +
				"  5F2A (terminal currency code) 2 bytes\n" +
				"  9A (transaction date) 3 bytes\n" +
				"  9C (transaction type) 1 bytes\n" +
				"  9F37 (unpredictable number) 4 bytes\n" +
				"  9F35 (terminal type) 1 bytes\n" +
				"  9F45 (data authentication code) 2 bytes\n" +
				"  9F4C (ICC dynamic number) 8 bytes\n" +
				"  9F34 (CVM Results - Cardholder Verification Results) 3 bytes\n" +
				"  9F15 (merchant category code) 2 bytes\n" +
				"8D (CDOL 2 - Card risk management data object list 2): 910A8A0295059F37049F4C08\n" +
				"  91 (issuer authentication data) 10 bytes\n" +
				"  8A (authorisation response code) 2 bytes\n" +
				"  95 (TVR - Terminal Verification Results) 5 bytes\n" +
				"  9F37 (unpredictable number) 4 bytes\n" +
				"  9F4C (ICC dynamic number) 8 bytes\n" +
				"90 (issuer public key certificate): 83E28958C1C1A1AA31DD4611C3B3B1FCBEE937B92A7ED93AE49D9510028907C4F5A685AF2A100FA347282F1BB3ADF26E2CB495080B20AE4A5614A9DF6602764177FBEE38624489AC6C4C054EAFC305D895A76885CE53A1BFDF5CB6CCE42E8E0E12382DB606490EE8075BC69D90205614B27745F7D883DB449758C340888B47B947945F062348A4DD4636D75A5D421638B6CA86B0618005C9F8F5D59DED345130123F0BD8C1EF7EC6F32A38BD0421FC39\n" +
				"92 (issuer public key remainder): 24A72C60B6F51D90F08F422DBA97429B21017F8080A05933C0A4D70728BD68E665CD19E1\n" +
				"9F8410 (?): 9291EA7DB1EA276A8C96999D\n" +
				"F5 (?): A69F86109C7C13CB1EBCD8C38818CB4EE91D\n" +
				"A1 (?): 9F8810FC28203B337296C500C3A272DA4767569F8A10253BC17EE2DE49451157405E9EA8C78D9F8503D119AC9F8703E6DF7C9F8903E08A739F8B0345C962DF2008ABE7D77B1E6970CB9F1101019F120A4D41535445524341\n" +
				"52 (?): 9F38039F1A029F49039F37049F4401028407A0000000041010BF0C059F4D020B0A9F2301009F1401009F42020643C303000000C403195000C50319FB00C7012DC8020643\n" +
				"C9 (?): 0643\n" +
				"CA (?): 000000000000\n" +
				"CB (?): 000000000000\n" +
				"D1 (?): 06430000000643000000064300000006430000000643000000\n" +
				"D3 (?): 000000000000000000000000000000000000\n" +
				"D5 (?): 04180200\n" +
				"D6 (?): 0010\n" +
				"9F7E (?): 031021120002000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n" +
				"56 (track 1 equivalent data): B5420485537788154^ /^1508221010000000000000000000000\n" +
				"9F62 (?): 00000000000E\n" +
				"9F63 (?): 00000000FE00\n" +
				"9F64 (?): 05\n" +
				"9F65 (?): 000E\n" +
				"9F66 (?): 07F0\n" +
				"9F67 (?): 05\n" +
				"9F6B (?): 5420485537788154D15082210100000000000F\n" +
				"D7 (?): 000024E0\n" +
				"D8 (?): 1980\n" +
				"D9 (?): 0801010010010301\n" +
				"DA (?): 0000\n" +
				"DB (?): 0000\n" +
				"DC (?): 1E82\n" +
				"DD (?): EA12\n" +
				"Error: Failed parsing TLV with tag 9F8C81B0A817: Bad length: -1799915264 < 0. Read 4 of 126 (0xFE) bytes used to encode length of TLV.\n"));
	}
}
